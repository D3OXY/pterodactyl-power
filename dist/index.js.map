{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import * as core from \"@actions/core\";\nimport axios from \"axios\";\n\nconst PowerActionOptions = [\"start\", \"stop\", \"restart\", \"kill\"];\nlet url: URL;\n\nlet panelURL = core.getInput(\"PANEL_URL\", { required: true });\nlet API_KEY = core.getInput(\"API_KEY\", { required: true });\nlet serverID = core.getInput(\"SERVER_ID\", { required: true });\nlet powerAction = core.getInput(\"POWER_ACTION\").toLowerCase() || \"restart\";\n\nif (panelURL.endsWith(\"/\")) {\n    panelURL = panelURL.slice(0, -1);\n}\n\nif (!PowerActionOptions.includes(powerAction)) {\n    core.setFailed(\n        `Invalid power action: ${powerAction}. Must be one of: ${PowerActionOptions.join(\n            \", \"\n        )}`\n    );\n    process.exit(1);\n}\n\ntry {\n    url = new URL(`${panelURL}/api/client/servers/${serverID}/power`);\n} catch (e) {\n    core.setFailed(`Invalid panel URL: ${panelURL}`);\n    process.exit(1);\n}\n\naxios.defaults.headers.common[\"Authorization\"] = `Bearer ${API_KEY}`;\naxios.defaults.headers.common[\"Content-Type\"] = \"application/json\";\n\naxios\n    .post(url.href, { signal: powerAction })\n    .then((res) => {\n        core.info(`Power action ${powerAction} sent to server ${serverID}`);\n        process.exit(0);\n    })\n    .catch((err) => {\n        core.setFailed(\n            `Error sending power action ${powerAction} to server ${serverID}: ${err}`\n        );\n        process.exit(1);\n    });\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,WAAsB;AACtB,mBAAkB;AAElB,IAAM,qBAAqB,CAAC,SAAS,QAAQ,WAAW,MAAM;AAC9D,IAAI;AAEJ,IAAI,WAAgB,cAAS,aAAa,EAAE,UAAU,KAAK,CAAC;AAC5D,IAAI,UAAe,cAAS,WAAW,EAAE,UAAU,KAAK,CAAC;AACzD,IAAI,WAAgB,cAAS,aAAa,EAAE,UAAU,KAAK,CAAC;AAC5D,IAAI,cAAmB,cAAS,cAAc,EAAE,YAAY,KAAK;AAEjE,IAAI,SAAS,SAAS,GAAG,GAAG;AACxB,aAAW,SAAS,MAAM,GAAG,EAAE;AACnC;AAEA,IAAI,CAAC,mBAAmB,SAAS,WAAW,GAAG;AAC3C,EAAK;AAAA,IACD,yBAAyB,WAAW,qBAAqB,mBAAmB;AAAA,MACxE;AAAA,IACJ,CAAC;AAAA,EACL;AACA,UAAQ,KAAK,CAAC;AAClB;AAEA,IAAI;AACA,QAAM,IAAI,IAAI,GAAG,QAAQ,uBAAuB,QAAQ,QAAQ;AACpE,SAAS,GAAG;AACR,EAAK,eAAU,sBAAsB,QAAQ,EAAE;AAC/C,UAAQ,KAAK,CAAC;AAClB;AAEA,aAAAA,QAAM,SAAS,QAAQ,OAAO,eAAe,IAAI,UAAU,OAAO;AAClE,aAAAA,QAAM,SAAS,QAAQ,OAAO,cAAc,IAAI;AAEhD,aAAAA,QACK,KAAK,IAAI,MAAM,EAAE,QAAQ,YAAY,CAAC,EACtC,KAAK,CAAC,QAAQ;AACX,EAAK,UAAK,gBAAgB,WAAW,mBAAmB,QAAQ,EAAE;AAClE,UAAQ,KAAK,CAAC;AAClB,CAAC,EACA,MAAM,CAAC,QAAQ;AACZ,EAAK;AAAA,IACD,8BAA8B,WAAW,cAAc,QAAQ,KAAK,GAAG;AAAA,EAC3E;AACA,UAAQ,KAAK,CAAC;AAClB,CAAC;","names":["axios"]}